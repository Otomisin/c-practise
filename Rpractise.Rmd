---
title: "RPractise"
author: "Oluwatosin Orenaike"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tidyverse)
library(ggtext)
library(ggplot2)
library(janitor)
library(sf)
library(units)
```


```{r}

# Load the necessary library
library(sf)

# Define the vectors for longitude and latitude
longitude <- c(-116.7, -120.4, -116.7, -113.5, -115.5, -120.8, -119.5, -113.7, -113.7, -110.7)
latitude <- c(45.3, 42.6, 38.9, 42.1, 35.7, 38.9, 36.2, 39, 41.6, 36.9)

# Combine the first five pairs of coordinates
bindsf <- cbind(longitude[1:5], latitude[1:5])

# Close the polygon by adding the first point at the end
bindsfr <- rbind(bindsf, c(longitude[1], latitude[1]))

# Convert to list
bindsfrlist <- list(bindsfr)

# Create a polygon object
bindsfrlistpol <- st_polygon(bindsfrlist)

# Plot the polygon
plot(bindsfrlistpol)

```

```{r}
plot(st_multipoint(cbind(longitude, latitude)))
```
```{r}
longitude <- c(-116.7, -120.4, -116.7, -113.5, -115.5, -120.8, -119.5, -113.7, -113.7, -110.7)
latitude <- c(45.3, 42.6, 38.9, 42.1, 35.7, 38.9, 36.2, 39, 41.6, 36.9)

linesf = cbind(longitude[1:4], latitude[1:4])

linesfv2 = linesf |> 
  as.data.frame() |> 
  st_as_sf( coords = c("longitude","latitude" ),crs = 4326)

plot(st_polygon(list(polysfv2)))


plot(st_linestring(linesf))


```

```{r}
linesf = cbind(longitude[1], latitude[1])

plot(st_multipoint(linesf))
```
```{r}
multilinestring <- st_multilinestring(list(cbind(longitude[1:5], latitude[1:5]), cbind(longitude[6:10], latitude[6:10])))

plot(multilinestring)

# Combine first five pairs of longitude and latitude
line1 <- cbind(longitude[1:5], latitude[1:5])

# Combine next five pairs of longitude and latitude
line2 <- cbind(longitude[6:10], latitude[6:10])

# Create a list of these two lines
lines_list <- list(line1, line2)

# Create a multi-linestring object
multi_line <- st_multilinestring(lines_list)

# Print the multi-linestring object
print(multi_line)
```

```{r}
point <- st_point(c(longitude[1], latitude[1]))

multipoint <- st_multipoint(cbind(longitude, latitude))

multilinestring <- st_multilinestring(list(cbind(longitude[1:5], latitude[1:5]), cbind(longitude[6:10], latitude[6:10])))

geom_collection <- st_geometrycollection(list(point, multipoint, multilinestring))

plot(geom_collection)

st_make_valid(geom_collection)

```

```{r}
longitude <- c(-116.7, -120.4, -116.7, -113.5, -115.5, -120.8, -119.5, -113.7, -113.7, -110.7)
latitude <- c(45.3, 42.6, 38.9, 42.1, 35.7, 38.9, 36.2, 39, 41.6, 36.9)

line = st_linestring(cbind(longitude[1:5], latitude[1:5]))
# st_length(line)

line = st_sfc(line, crs = 4326)

# Assgin a projected coordinate
line2 = st_transform(line, crs = 26391)

# Calculate length in meters
length_in_meters <- st_length(line2)

# Convert length to kilometers
length_in_km <- set_units(length_in_meters, km)

# Print the length in kilometers
print(length_in_km)

```

